<Application
    x:Class="Orbit.App"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dragablz="clr-namespace:Dragablz;assembly=Dragablz"
    xmlns:local="clr-namespace:Orbit"
    ShutdownMode="OnLastWindowClose">
    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!--  MahApps.Metro v2 - Combined theme file (replaces separate base + accent)  -->
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Themes/Dark.Cyan.xaml" />

                <!--  Dragablz MahApps theme  -->
                <ResourceDictionary Source="pack://application:,,,/Dragablz;component/Themes/mahapps.xaml" />

                <!--  Orbit Session Templates - Unified across Main and Orbit View  -->
                <ResourceDictionary Source="Resources/SessionTemplates.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <Style BasedOn="{StaticResource MahAppsTabablzControlStyle}" TargetType="{x:Type dragablz:TabablzControl}">
                <Setter Property="ShowDefaultAddButton" Value="False" />
                <Setter Property="ShowDefaultCloseButton" Value="True" />
            </Style>

            <!-- Shared outer margin for tool pages (tighter than the original 16px). -->
            <Thickness x:Key="Orbit.ToolPageMargin">12</Thickness>

            <!--  Orbit Grid Cell Style - for TabablzControls in Orbit View grid layout  -->
            <Style
                x:Key="OrbitGridCellStyle"
                BasedOn="{StaticResource MahAppsTabablzControlStyle}"
                TargetType="{x:Type dragablz:TabablzControl}">
                <Setter Property="ShowDefaultAddButton" Value="False" />
                <Setter Property="ShowDefaultCloseButton" Value="True" />
                <Setter Property="BorderBrush" Value="{DynamicResource MahApps.Brushes.Accent}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="Background" Value="{DynamicResource MahApps.Brushes.ThemeBackground}" />
            </Style>

            <!--  Fallback style for MahApps toggle buttons (Orbit only consumes the square variant)  -->
            <Style x:Key="MahApps.Styles.ToggleButton.Square" TargetType="ToggleButton">
                <Setter Property="Width" Value="28" />
                <Setter Property="Height" Value="28" />
                <Setter Property="Padding" Value="0" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Background" Value="{DynamicResource MahApps.Brushes.Gray7}" />
                <Setter Property="BorderBrush" Value="{DynamicResource MahApps.Brushes.Gray5}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="Foreground" Value="{DynamicResource MahApps.Brushes.IdealForeground}" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ToggleButton">
                            <Border
                                x:Name="Border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                                <ContentPresenter
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    RecognizesAccessKey="True" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Border" Property="Background" Value="{DynamicResource MahApps.Brushes.Gray6}" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="Border" Property="Background" Value="{DynamicResource MahApps.Brushes.Gray5}" />
                                </Trigger>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="Border" Property="Background" Value="{DynamicResource MahApps.Brushes.Accent}" />
                                    <Setter Property="Foreground" Value="{DynamicResource MahApps.Brushes.IdealForeground}" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="Border" Property="Opacity" Value="0.5" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!--  Orbit-specific primary button style to mirror legacy accent treatment  -->
            <Style
                x:Key="MahApps.Styles.Button.Primary"
                BasedOn="{StaticResource MahApps.Styles.Button}"
                TargetType="Button">
                <Setter Property="Padding" Value="14,6" />
                <Setter Property="FontWeight" Value="SemiBold" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="BorderBrush" Value="{DynamicResource MahApps.Brushes.Accent3}" />
                <Setter Property="Background">
                    <Setter.Value>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                            <GradientStop Offset="0" Color="{DynamicResource MahApps.Colors.Accent}" />
                            <GradientStop Offset="1" Color="{DynamicResource MahApps.Colors.Accent2}" />
                        </LinearGradientBrush>
                    </Setter.Value>
                </Setter>
                <Setter Property="Foreground" Value="{DynamicResource MahApps.Brushes.IdealForeground}" />
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Opacity" Value="0.95" />
                    </Trigger>
                    <Trigger Property="IsPressed" Value="True">
                        <Setter Property="Opacity" Value="0.85" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Opacity" Value="0.6" />
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!--  Shared tool header visuals  -->
            <Style x:Key="Orbit.ToolHeader" TargetType="Border">
                <Setter Property="Margin" Value="0,0,0,16" />
                <Setter Property="Padding" Value="18,16" />
                <Setter Property="CornerRadius" Value="12" />
                <Setter Property="Background">
                    <Setter.Value>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                            <GradientStop Offset="0" Color="{DynamicResource MahApps.Colors.Accent}" />
                            <GradientStop Offset="0.55" Color="{DynamicResource MahApps.Colors.Accent2}" />
                            <GradientStop Offset="1" Color="{DynamicResource MahApps.Colors.Accent3}" />
                        </LinearGradientBrush>
                    </Setter.Value>
                </Setter>
                <Setter Property="Effect">
                    <Setter.Value>
                        <DropShadowEffect
                            BlurRadius="18"
                            Direction="310"
                            Opacity="0.28"
                            ShadowDepth="3"
                            Color="#66000000" />
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="Orbit.ToolHeaderIcon" TargetType="Border">
                <Setter Property="Width" Value="52" />
                <Setter Property="Height" Value="52" />
                <Setter Property="Margin" Value="0,0,14,0" />
                <Setter Property="CornerRadius" Value="26" />
                <Setter Property="HorizontalAlignment" Value="Center" />
                <Setter Property="VerticalAlignment" Value="Center" />
                <Setter Property="Background" Value="#33FFFFFF" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="BorderBrush" Value="#55FFFFFF" />
                <Setter Property="Effect">
                    <Setter.Value>
                        <DropShadowEffect
                            BlurRadius="12"
                            Direction="315"
                            Opacity="0.4"
                            ShadowDepth="2"
                            Color="#3F000000" />
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="Orbit.ToolCard" TargetType="Border">
                <Setter Property="Margin" Value="0,14,0,0" />
                <Setter Property="Padding" Value="14" />
                <Setter Property="CornerRadius" Value="10" />
                <Setter Property="Background" Value="{DynamicResource MahApps.Brushes.ThemeBackground}" />
                <Setter Property="BorderBrush" Value="{DynamicResource MahApps.Brushes.Gray6}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="Effect">
                    <Setter.Value>
                        <DropShadowEffect
                            BlurRadius="14"
                            Opacity="0.12"
                            ShadowDepth="2"
                            Color="{DynamicResource MahApps.Colors.ThemeForeground}" />
                    </Setter.Value>
                </Setter>
            </Style>

            <!--  Orbit icon geometry - shared across all icon uses for consistency  -->
            <!--  Sourced from Orbital.svg  -->
            <PathGeometry x:Key="Orbit.IconGeometry" Figures="M256.25,20.656c-32.78,0-64.03,6.79-92.438,19-8.182-10.618-20.994-17.468-35.437-17.468-24.716,0-44.78,20.033-44.78,44.75,0,8.356,2.324,16.18,6.31,22.874-42.638,42.655-69.093,101.49-69.093,166.282,0,129.617,105.823,234.72,235.438,234.72,129.615-.002,234.72-105.103,234.72-234.72,0-129.618-105.105-235.438-234.72-235.438Zm0,19.313c119.515,0,216.094,96.607,216.094,216.124s-96.58,216.094-216.094,216.094c-119.515,0-216.813-96.577-216.813-216.094,0-59.568,24.176-113.438,63.22-152.5,7.273,5.113,16.15,8.094,25.718,8.094,24.716,0,44.75-20.034,44.75-44.75,0-3.453-.385-6.804-1.125-10.032C197.91,46,226.396,39.97,256.25,39.97Zm-.125,51.81c-91.3,0-165.875,74.575-165.875,165.876,0,91.3,74.576,165.406,165.875,165.406,35.12,0,67.708-10.965,94.5-29.656,7.13,4.23,15.45,6.656,24.344,6.656,26.396,0,47.81-21.384,47.81-47.78,0-12.763-5.005-24.366-13.155-32.938,7.677-19.067,11.906-39.884,11.906-61.688,0-91.3-74.106-165.875-165.405-165.875Zm0,19.126c81.2,0,146.78,65.55,146.78,146.75,0,17.833-3.172,34.924-8.967,50.72-5.81-2.513-12.237-3.907-18.97-3.907-26.396,0-47.78,21.414-47.78,47.81,0,10.59,3.454,20.362,9.28,28.283-23.065,15.084-50.66,23.843-80.343,23.843-81.2,0-147.22-65.55-147.22-146.75s66.02-146.75,147.22-146.75Zm-1.063,19.625c-7.462,31.99-21.767,62.112-42.906,83.25-21.14,21.14-48.73,32.913-80.72,40.376,31.99,7.462,62.112,21.736,83.25,42.875,21.14,21.14,32.914,48.764,40.376,80.75,7.463-31.986,19.204-59.61,40.344-80.75,21.14-21.138,51.262-35.412,83.25-42.874-32.236-7.428-59.455-19.11-80.72-40.375-21.262-21.263-35.446-51.013-42.873-83.25Zm.094,86.564c20.498,0,37.125,16.627,37.125,37.125,0,20.496-16.626,37.124-37.124,37.124-20.497,0-37.125-16.628-37.125-37.125,0-20.5,16.63-37.126,37.126-37.126Z" />

            <!--  DrawingImage for use in Image controls (title bar, etc)  -->
            <DrawingImage x:Key="Orbit.IconImage">
                <DrawingImage.Drawing>
                    <DrawingGroup ClipGeometry="M0,0 V512 H512 V0 H0 Z">
                        <!--  Transparent background to ensure proper bounds  -->
                        <GeometryDrawing Brush="Transparent">
                            <GeometryDrawing.Geometry>
                                <RectangleGeometry Rect="0,0,512,512" />
                            </GeometryDrawing.Geometry>
                        </GeometryDrawing>
                        <!--  Main icon with theme-adaptive foreground  -->
                        <GeometryDrawing Brush="{DynamicResource MahApps.Brushes.IdealForeground}" Geometry="{StaticResource Orbit.IconGeometry}" />
                    </DrawingGroup>
                </DrawingImage.Drawing>
            </DrawingImage>

        </ResourceDictionary>
    </Application.Resources>

</Application>
